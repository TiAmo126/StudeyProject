<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>promise学习（未完）</title>
</head>
<body>

<script type="text/javascript">
  /**
   *
   * Promise 对象用于表示一个异步操作的最终完成 (或失败), 及其结果值
   * promise的参数为带两个参数的函数<resolve表明异步操作完成执行成功><reject表明异步操作执行失败>
   *
   * */
  // promise封装原生ajax
  function miseXhr(url, method, data, async, timeout) {
    let xhr = new XMLHttpRequest();//创建xhr对象
    return new Promise(function (resolve, reject) {//创建promise对象
      xhr.open(method,url,async)//发送请求
      xhr.timeout = option.timeout;
      xhr.onloadend = function () {
        if (xhr.status >= 200 && xhr.status < 300 || xhr.status == 304) {
          resolve(xhr)
        } else {
          reject({
            errorType: 'status_error',
            xhr: xhr
          })
        }
        xhr.send(data)//开始请求
        xhr.onabort = function () {//错误处理
          reject(new Error({
            errorType: 'abort_error',
            xhr: xhr
          }));
        };
        xhr.ontimeout = function () {
          reject({
            errorType: 'timeout_error',
            xhr: xhr
          })
        };
        xhr.onerror = function () {
          reject({
            errorType: 'onerror',
            xhr: xhr
          })
        }
      }
    })
  }
</script>
</body>
</html>